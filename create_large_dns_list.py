#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
创建大型DNS反射器列表
包含全球各地的DNS服务器
"""

def create_large_dns_list():
    """创建包含数千个DNS服务器的列表"""
    
    dns_servers = []
    
    # 1. 主要公共DNS服务器
    major_dns = [
        # Google DNS
        "8.8.8.8", "8.8.4.4", "8.8.8.4", "8.8.4.8",
        
        # Cloudflare DNS
        "1.1.1.1", "1.0.0.1", "1.1.1.2", "1.0.0.2", "1.1.1.3", "1.0.0.3",
        
        # OpenDNS
        "208.67.222.222", "208.67.220.220", "208.67.222.220", "208.67.220.222",
        
        # Quad9
        "9.9.9.9", "149.112.112.112", "9.9.9.10", "149.112.112.10",
        
        # Level3
        "4.2.2.1", "4.2.2.2", "4.2.2.3", "4.2.2.4", "4.2.2.5", "4.2.2.6",
        
        # Verisign
        "64.6.64.6", "64.6.65.6",
        
        # Comodo
        "8.26.56.26", "8.20.247.20",
        
        # Norton
        "199.85.126.10", "199.85.127.10",
        
        # Yandex
        "77.88.8.8", "77.88.8.1", "77.88.8.88", "77.88.8.2",
    ]
    dns_servers.extend(major_dns)
    
    # 2. 中国DNS服务器
    china_dns = [
        # 114DNS
        "114.114.114.114", "114.114.115.115", "114.114.114.115", "114.114.115.114",
        
        # 阿里DNS
        "223.5.5.5", "223.6.6.6", "223.5.5.6", "223.6.6.5",
        
        # 腾讯DNS
        "119.29.29.29", "182.254.116.116", "119.28.28.28", "182.254.118.118",
        
        # 百度DNS
        "180.76.76.76", "180.76.76.77",
        
        # 中国电信DNS
        "202.96.209.133", "202.96.209.5", "202.96.128.86", "202.96.128.166",
        "202.102.224.68", "202.102.227.68", "202.96.134.33", "202.96.128.68",
        
        # 中国联通DNS
        "221.5.88.88", "221.6.4.66", "210.2.4.8", "61.139.2.69",
        
        # 其他中国DNS
        "218.30.19.40", "218.85.157.99", "218.104.111.122", "61.134.1.4",
    ]
    dns_servers.extend(china_dns)
    
    # 3. 生成IP段范围
    ip_ranges = [
        # Google IP段
        ("8.8.8", 1, 255),
        ("8.8.4", 1, 255),
        ("8.34.208", 1, 100),
        ("8.35.200", 1, 100),
        
        # Cloudflare IP段
        ("1.1.1", 1, 255),
        ("1.0.0", 1, 255),
        
        # OpenDNS IP段
        ("208.67.222", 1, 255),
        ("208.67.220", 1, 255),
        
        # Level3 IP段
        ("4.2.2", 1, 255),
        ("4.2.1", 1, 100),
        
        # 中国电信IP段
        ("202.96.209", 1, 255),
        ("202.96.128", 1, 255),
        ("202.102.224", 1, 255),
        ("202.102.227", 1, 255),
        ("61.139.2", 1, 255),
        ("218.85.157", 1, 255),
        
        # 中国联通IP段
        ("221.5.88", 1, 255),
        ("221.6.4", 1, 255),
        ("210.2.4", 1, 255),
        ("61.134.1", 1, 255),
        
        # 其他常见DNS IP段
        ("77.88.8", 1, 255),  # Yandex
        ("156.154.70", 1, 255),  # Neustar
        ("156.154.71", 1, 255),  # Neustar
        ("64.6.64", 1, 255),  # Verisign
        ("64.6.65", 1, 255),  # Verisign
        
        # 台湾DNS IP段
        ("168.95.1", 1, 255),
        ("168.95.192", 1, 255),
        ("203.74.205", 1, 255),
        
        # 香港DNS IP段
        ("203.80.96", 1, 255),
        ("202.45.84", 1, 255),
        ("202.14.67", 1, 255),
        
        # 欧洲DNS IP段
        ("194.242.2", 1, 255),
        ("80.80.80", 1, 255),
        ("37.235.1", 1, 255),
        ("89.233.43", 1, 255),
        
        # 美国其他DNS IP段
        ("199.85.126", 1, 255),
        ("199.85.127", 1, 255),
        ("185.228.168", 1, 255),
        ("185.228.169", 1, 255),
        ("76.76.19", 1, 255),
        ("76.223.100", 1, 255),
    ]
    
    # 生成IP地址
    for base_ip, start, end in ip_ranges:
        for i in range(start, min(end + 1, 256)):
            ip = f"{base_ip}.{i}"
            if ip not in dns_servers:
                dns_servers.append(ip)
    
    return dns_servers

def main():
    """主函数"""
    print("创建大型DNS反射器列表...")
    
    dns_list = create_large_dns_list()
    
    # 保存到文件
    with open("reflector_lists/large_dns_servers.txt", "w") as f:
        for dns in dns_list:
            f.write(f"{dns}\n")
    
    print(f"✅ 已创建包含 {len(dns_list)} 个DNS服务器的列表")
    print("📁 文件保存到: reflector_lists/large_dns_servers.txt")
    print("\n⚠️ 注意:")
    print("- 此列表包含大量未验证的IP地址")
    print("- 建议使用前先进行有效性测试")
    print("- 仅用于合法的安全测试目的")

if __name__ == "__main__":
    main()
